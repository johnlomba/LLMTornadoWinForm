<Window x:Class="SmarterViews.Desktop.ConnectionStringBuilderWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Connection String Builder" Height="550" Width="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#1976D2" Padding="15,10">
            <TextBlock Text="Build Connection String" Foreground="White" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
        </Border>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20">
                <!-- Database Type -->
                <TextBlock Text="Database Type:" FontSize="12" Margin="0,0,0,5"/>
                <ComboBox x:Name="DatabaseTypeComboBox" 
                          Height="35" Padding="10" Margin="0,0,0,15"
                          SelectionChanged="DatabaseType_SelectionChanged"/>

                <!-- SQL Server / MySQL / PostgreSQL / Oracle Fields -->
                <StackPanel x:Name="ServerBasedPanel" Visibility="Visible">
                    <!-- Server -->
                    <TextBlock Text="Server / Host:" FontSize="12" Margin="0,0,0,5"/>
                    <TextBox x:Name="ServerTextBox" Height="35" Padding="10" BorderBrush="#CCCCCC" BorderThickness="1" Margin="0,0,0,15" TextChanged="ServerTextBox_TextChanged"/>

                    <!-- Port -->
                    <TextBlock Text="Port (optional):" FontSize="12" Margin="0,0,0,5"/>
                    <TextBox x:Name="PortTextBox" Height="35" Padding="10" BorderBrush="#CCCCCC" BorderThickness="1" Margin="0,0,0,15" TextChanged="PortTextBox_TextChanged"/>

                    <!-- Database -->
                    <TextBlock Text="Database / Schema:" FontSize="12" Margin="0,0,0,5"/>
                    <TextBox x:Name="DatabaseTextBox" Height="35" Padding="10" BorderBrush="#CCCCCC" BorderThickness="1" Margin="0,0,0,15" TextChanged="DatabaseTextBox_TextChanged"/>

                    <!-- Integrated Security (SQL Server only) -->
                    <CheckBox x:Name="IntegratedSecurityCheckBox" 
                              Content="Use Windows Authentication (Integrated Security)" 
                              Margin="0,0,0,15"
                              Checked="IntegratedSecurity_Changed"
                              Unchecked="IntegratedSecurity_Changed"/>

                    <!-- Username -->
                    <TextBlock x:Name="UsernameLabel" Text="Username:" FontSize="12" Margin="0,0,0,5"/>
                    <TextBox x:Name="UsernameTextBox" Height="35" Padding="10" BorderBrush="#CCCCCC" BorderThickness="1" Margin="0,0,0,15" TextChanged="UsernameTextBox_TextChanged"/>

                    <!-- Password -->
                    <TextBlock x:Name="PasswordLabel" Text="Password:" FontSize="12" Margin="0,0,0,5"/>
                    <PasswordBox x:Name="PasswordBox" Height="35" Padding="10" BorderBrush="#CCCCCC" BorderThickness="1" Margin="0,0,0,15" PasswordChanged="PasswordBox_PasswordChanged"/>
                </StackPanel>

                <!-- SQLite Fields -->
                <StackPanel x:Name="SQLitePanel" Visibility="Collapsed">
                    <TextBlock Text="Database File Path:" FontSize="12" Margin="0,0,0,5"/>
                    <Grid Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox x:Name="FilePathTextBox" Grid.Column="0" Height="35" Padding="10" BorderBrush="#CCCCCC" BorderThickness="1" Margin="0,0,10,0" TextChanged="FilePathTextBox_TextChanged"/>
                        <Button Grid.Column="1" Content="Browse..." Width="80" Height="35" Click="BrowseFile_Click" Background="#F0F0F0"/>
                    </Grid>
                </StackPanel>

                <!-- Preview -->
                <TextBlock Text="Connection String Preview:" FontSize="12" Margin="0,10,0,5" FontWeight="Bold"/>
                <TextBox x:Name="PreviewTextBox" 
                         Height="80" Padding="10" BorderBrush="#CCCCCC" BorderThickness="1" 
                         TextWrapping="Wrap" IsReadOnly="True" Background="#F9F9F9"
                         VerticalScrollBarVisibility="Auto"/>
            </StackPanel>
        </ScrollViewer>

        <!-- Footer -->
        <Border Grid.Row="2" Background="#F5F5F5" Padding="15" BorderThickness="0,1,0,0" BorderBrush="#CCCCCC">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Test Connection" Width="120" Height="35" Margin="0,0,10,0" Click="TestConnection_Click" Background="#FF9800" Foreground="White"/>
                <Button Content="Use This Connection String" Width="180" Height="35" Margin="0,0,10,0" Click="UseConnectionString_Click" Background="#4CAF50" Foreground="White"/>
                <Button Content="Cancel" Width="80" Height="35" Click="Cancel_Click" Background="#757575" Foreground="White"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
